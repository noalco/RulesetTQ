<?xml version="1.0" encoding="UTF-8"?>
<root>
	<windowclass name="item_main2">	
		<margins control="0,0,0,2" />
		<script file="campaign/scripts/item_main.lua" />
		<sheetdata>
		
			<button_record_locked name="">
				<invisible />
				<bounds>36,53,60,30</bounds>
				<script>
					function onInit()
						onValueChanged();
						super.onInit();
					end

					function onValueChanged()
						local bCerrado=getValue()==1;
						local bEsArma= window.TipoObjeto.getValue()==4;
						local bEsObjeto= window.TipoObjeto.getValue()==5;
						local bEsArmadura= window.TipoObjeto.getValue()==6;
						local bEsYelmo= window.TipoObjeto.getValue()==7;
						local bEsEscudo= window.TipoObjeto.getValue()==8;
						local sUsoArma=DB.getValue(window.getDatabaseNode(), "UsoArma", "");
						local bEsLongitud=sUsoArma==Inventario.CteUnaMano or sUsoArma==Inventario.CteDosManos or sUsoArma==Inventario.CteUnaDosManos;
						local bEsAlcance=sUsoArma==Inventario.CteRango or sUsoArma==Inventario.CteArrojadiza;
												
						window.BotonArma.setReadOnly(bCerrado);
						window.BotonArmadura.setReadOnly(bCerrado);
						window.BotonEscudo.setReadOnly(bCerrado);
						window.BotonYelmo.setReadOnly(bCerrado);
						window.BotonMisc.setReadOnly(bCerrado);

						window.Defensa.setReadOnly(bCerrado);
						window.TipoDefensa.setReadOnly(bCerrado);
						window.DanioDefensa.setReadOnly(bCerrado);
						window.TamanioArmadura.setReadOnly(bCerrado);

						window.BonoDanio.setReadOnly(bCerrado);
						window.EfectoDanio.setReadOnly(bCerrado);
						window.BonoAtaqueArma.setReadOnly(bCerrado);
						window.TipoArma.setReadOnly(bCerrado);
						window.Longitud.setReadOnly(bCerrado);
						window.Alcance.setReadOnly(bCerrado);
						window.UsoArma.setReadOnly(bCerrado);
						window.EfectoDanio.setReadOnly(bCerrado);
						window.HabilidadCC.setReadOnly(bCerrado);
						window.HabilidadPr.setReadOnly(bCerrado);
						window.HabilidadAr.setReadOnly(bCerrado);
						window.Recarga.setReadOnly(bCerrado);
												
						window.Habilidad.setVisible(bEsEscudo);

						if bCerrado then
							window.LabelBonoDefensa.setVisible((bEsArmadura or bEsYelmo or bEsEscudo) and window.Defensa.getValue()~=0);
							window.Defensa.setVisible((bEsArmadura or bEsYelmo or bEsEscudo) and window.Defensa.getValue()~=0);
							window.LabelTipoArmadura.setVisible(bEsArmadura and window.TipoDefensa.getValue()~="");
							window.TipoDefensa.setVisible(bEsArmadura and window.TipoDefensa.getValue()~="");
							window.LabelDanioDefensa.setVisible((bEsArmadura or bEsEscudo) and window.DanioDefensa.getValue()~=0);
							window.DanioDefensa.setVisible((bEsArmadura or bEsEscudo) and window.DanioDefensa.getValue()~=0);
							window.LabelTamanioArmadura.setVisible((bEsArmadura  or bEsCasco) and window.TamanioArmadura.getValue()~="");
							window.TamanioArmadura.setVisible((bEsArmadura  or bEsCasco) and window.TamanioArmadura.getValue()~="");

							window.LabelHabilidad.setVisible(bEsArma and window.Habilidad.getValue()~="" or bEsEscudo);
							window.LabelDanio.setVisible((bEsArma or bEsEscudo) and window.BonoDanio.getValue()~=0);
							window.BonoDanio.setVisible((bEsArma or bEsEscudo) and window.BonoDanio.getValue()~=0);
							window.EfectoDanio.setVisible((bEsArma or bEsEscudo) and window.EfectoDanio.getValue()~="");
							window.LabelBonoAtaqueArma.setVisible((bEsArma or bEsEscudo) and window.BonoAtaqueArma.getValue()~=0);
							window.BonoAtaqueArma.setVisible((bEsArma or bEsEscudo) and window.BonoAtaqueArma.getValue()~=0);
							window.LabelFuerzaMinima.setVisible((bEsArma or bEsEscudo) and window.FuerzaMinima.getValue()~=0);
							window.FuerzaMinima.setVisible((bEsArma or bEsEscudo) and window.FuerzaMinima.getValue()~=0);

							window.LabelTipoArma.setVisible((bEsArma or bEsEscudo) and window.TipoArma.getValue()~="");
							window.TipoArma.setVisible((bEsArma or bEsEscudo) and window.TipoArma.getValue()~="");
							window.LabelLongAlc.setVisible((bEsArma or bEsEscudo) and (window.Longitud.getValue()~="" or window.Alcance.getValue()~=""));
							window.Longitud.setVisible((bEsArma and bEsLongitud or bEsEscudo) and window.Longitud.getValue()~="");
							window.Alcance.setVisible(bEsArma and bEsAlcance and window.Alcance.getValue()~="");
							window.HabilidadCC.setVisible(bEsArma and window.HabilidadCC.getValue()~="" and (sUsoArma==Inventario.CteUnaMano or sUsoArma==Inventario.CteDosManos or sUsoArma==Inventario.CteUnaDosManos));
							window.HabilidadPr.setVisible(bEsArma and sUsoArma==Inventario.CteRango and window.HabilidadPr.getValue()~="");
							window.HabilidadAr.setVisible(bEsArma and sUsoArma==Inventario.CteArrojadiza and window.HabilidadAr.getValue()~="");
							
							window.PenalizacionPercepcion.setVisible(bEsYelmo and window.PenalizacionPercepcion.getValue()~=0);
							window.LabelPenalizacionPercepcion.setVisible(bEsYelmo and window.PenalizacionPercepcion.getValue()~=0);
							window.LabelTieneVisera.setVisible(bEsYelmo and window.TieneVisera.getValue()==1);
							window.TieneVisera.setVisible(bEsYelmo and window.TieneVisera.getValue()==1);
							
							window.LabelRecarga.setVisible(bEsArma and sUsoArma==Inventario.CteRango and window.Recarga.getValue()~="");
							window.Recarga.setVisible(bEsArma and sUsoArma==Inventario.CteRango and window.Recarga.getValue()~="");
							
						else
							window.Defensa.setReadOnly(bEsEscudo);
							
							window.LabelBonoDefensa.setVisible(bEsArmadura or bEsYelmo or bEsEscudo);
							window.Defensa.setVisible(bEsArmadura or bEsYelmo or bEsEscudo);
							window.LabelTipoArmadura.setVisible(bEsArmadura);
							window.TipoDefensa.setVisible(bEsArmadura);
							window.LabelDanioDefensa.setVisible(bEsArmadura or bEsEscudo);
							window.DanioDefensa.setVisible(bEsArmadura or bEsEscudo);
							window.LabelTamanioArmadura.setVisible(bEsArmadura or bEsCasco);
							window.TamanioArmadura.setVisible(bEsArmadura or bEsCasco);
							
							window.LabelHabilidad.setVisible(bEsArma or bEsEscudo);
							window.LabelDanio.setVisible(bEsArma or bEsEscudo);
							window.BonoDanio.setVisible(bEsArma or bEsEscudo);
							window.EfectoDanio.setVisible(bEsArma or bEsEscudo);
							window.LabelBonoAtaqueArma.setVisible(bEsArma or bEsEscudo);
							window.BonoAtaqueArma.setVisible(bEsArma or bEsEscudo);
							window.LabelFuerzaMinima.setVisible(bEsArma or bEsEscudo);
							window.FuerzaMinima.setVisible(bEsArma or bEsEscudo);
							window.LabelTipoArma.setVisible(bEsArma or bEsEscudo);
							window.TipoArma.setVisible(bEsArma or bEsEscudo);
							window.LabelLongAlc.setVisible(bEsArma or bEsEscudo);
							window.Longitud.setVisible(bEsArma and bEsLongitud or bEsEscudo);
							window.Alcance.setVisible(bEsArma and bEsAlcance);
							window.HabilidadCC.setVisible(bEsArma and (sUsoArma==Inventario.CteUnaMano or sUsoArma==Inventario.CteDosManos or sUsoArma==Inventario.CteUnaDosManos));
							window.HabilidadPr.setVisible(bEsArma and sUsoArma==Inventario.CteRango);
							window.HabilidadAr.setVisible(bEsArma and sUsoArma==Inventario.CteArrojadiza);

							window.PenalizacionPercepcion.setVisible(bEsYelmo);
							window.LabelPenalizacionPercepcion.setVisible(bEsYelmo);
							window.LabelTieneVisera.setVisible(bEsYelmo);
							window.TieneVisera.setVisible(bEsYelmo);
							
							window.LabelRecarga.setVisible(bEsArma and sUsoArma==Inventario.CteRango);
							window.Recarga.setVisible(bEsArma and sUsoArma==Inventario.CteRango);
						end
					end
				</script>
				<!--
						window.divider3.setReadOnly(bCerrado);


							window.LabelViseraLevantada.setVisible(bEsYelmo and window.TieneVisera.getValue()==1 and window.ViseraLevantada.getValue()==1);
							window.ViseraLevantada.setVisible(bEsYelmo and window.TieneVisera.getValue()==1 and window.ViseraLevantada.getValue()==1);




							window.Habilidad.setVisible(bEsArma and window.Habilidad.getValue()~="");
							window.Habilidad.setReadOnly(bCerrado);
							window.LabelViseraLevantada.setVisible(bEsYelmo and window.TieneVisera.getValue()==1);
							window.ViseraLevantada.setVisible(bEsYelmo and window.TieneVisera.getValue()==1);
				-->
			</button_record_locked>
			
			
			<!-- ***************************************************************************
				 ***************************************************************************
												Campos comunes
				 ***************************************************************************
				 *************************************************************************** -->

			<anchor_column name="columnanchor" />

			<label_column name="nonid_name_label">
				<static textres="item_label_unidentified" />
			</label_column>
			<string_columnh name="nonid_name" />
			
			<label_column name="nonid_notes_label">
				<static textres="item_label_unidentifiednotes" />
			</label_column>
			<string_columnh name="nonid_notes" />

			<line_column name="divider" />

			<label_column name="cost_label">
				<static textres="item_label_cost" />
			</label_column>
			<string_columnh name="cost" />

			<label_column name="weight_label">
				<static textres="item_label_weight" />
			</label_column>
			<number_columnh name="weight">
				<script>
					function onValueChanged()
						if window.TipoObjeto.getValue()==Inventario.CteEscudo then window.Defensa.setValue(window.weight.getValue()); end
					end
				</script>
			</number_columnh>

			<line_column name="divider2" />

			<ft_columnh name="notes" />
 
  			<sub_column name="sub_subitems" />


			<!-- ***************************************************************************
				 ***************************************************************************
												Botones de objetos
				 ***************************************************************************
				 *************************************************************************** -->

			<line_column name="divider4" />
			
			<label_column name="LabelTipoObjeto">
				<static textres="item_label_tipo_objeto" />
			</label_column>


			<genericcontrol name="BordeBotonArma">
				<frame>
					<name>ct_subgroupbox</name>
					<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelTipoObjeto" offset="-2"/>
					<left anchor="left" parent="LabelTipoObjeto" offset="87" />
					<size height="41" width="41" />
				</anchored>				
			</genericcontrol>

			<buttoncontrol name="BotonArma">
				<icon normal="ObjetoArma" />
				<font>button-white</font>
				<script>
					function onButtonPress()
						window.TipoObjeto.setValue(Inventario.CteArma);
						window.esEscudo.setValue(0);
						Inventario.GestionarInventario(window);
					end
				</script>
				<anchored>
					<top parent="LabelTipoObjeto"/>
					<left anchor="left" parent="LabelTipoObjeto" offset="89" />
					<size height="33" width="33" />
				</anchored>
			</buttoncontrol>
			
			
			<genericcontrol name="BordeBotonArmadura">
				<frame>
					<name>ct_subgroupbox</name>
					<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelTipoObjeto" offset="-2"/>
					<left anchor="right" parent="BotonArma" offset="2" />
					<size height="41" width="41" />
				</anchored>
			</genericcontrol>

			<buttoncontrol name="BotonArmadura">
				<icon normal="ObjetoArmadura" />
				<font>button-white</font>
				<script>
					function onButtonPress()
						window.TipoObjeto.setValue(Inventario.CteArmadura);
						window.esEscudo.setValue(0);
						window.Defensa.setReadOnly(false);
						Inventario.GestionarInventario(window);
					end
				</script>
				<anchored>
					<top parent="LabelTipoObjeto"/>
					<left anchor="right" parent="BotonArma" offset="5" />
					<size height="33" width="33" />
				</anchored>
			</buttoncontrol>
			
			
			<genericcontrol name="BordeBotonEscudo">
				<frame>
					<name>ct_subgroupbox</name>
					<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelTipoObjeto" offset="-2"/>
					<left anchor="right" parent="BotonArmadura" offset="4" />
					<size height="41" width="41" />
				</anchored>				
			</genericcontrol>

			<buttoncontrol name="BotonEscudo">
				<icon normal="ObjetoEscudo" />
				<font>button-white</font>
				<script>
					function onButtonPress()
						window.TipoObjeto.setValue(Inventario.CteEscudo);
						window.esEscudo.setValue(1);
						window.Defensa.setValue(window.weight.getValue());
						window.Defensa.setReadOnly(true);
						Inventario.GestionarInventario(window);
					end
				</script>
				<anchored>
					<top parent="LabelTipoObjeto" offset="4"/>
					<left anchor="right" parent="BotonArmadura" offset="9" />
					<size height="29" width="29" />
				</anchored>
			</buttoncontrol>


			<genericcontrol name="BordeBotonYelmo">
				<frame>
					<name>ct_subgroupbox</name>
					<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelTipoObjeto" offset="-2"/>
					<left anchor="right" parent="BotonEscudo" offset="4" />
					<size height="41" width="41" />
				</anchored>				
			</genericcontrol>

			<buttoncontrol name="BotonYelmo">
				<icon normal="ObjetoYelmo" />
				<font>button-white</font>
				<script>
					function onButtonPress()
						window.TipoObjeto.setValue(Inventario.CteYelmo);
						window.esEscudo.setValue(0);
						window.Defensa.setReadOnly(false);
						Inventario.GestionarInventario(window);
					end
				</script>
				<anchored>
					<top parent="LabelTipoObjeto" offset="4"/>
					<left anchor="right" parent="BotonEscudo" offset="10" />
					<size height="29" width="29" />
				</anchored>
			</buttoncontrol>


			<genericcontrol name="BordeBotonMisc">
				<frame>
					<name>ct_subgroupbox</name>
					<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelTipoObjeto" offset="-2"/>
					<left anchor="right" parent="BotonYelmo" offset="4" />
					<size height="41" width="41" />
				</anchored>				
			</genericcontrol>

			<buttoncontrol name="BotonMisc">
				<icon normal="ObjetoMisc" />
				<font>button-white</font>
				<script>
					function onButtonPress()
						window.TipoObjeto.setValue(Inventario.CteObjeto);
						window.esEscudo.setValue(0);
						Inventario.GestionarInventario(window);
					end
				</script>
				<anchored>
					<top parent="LabelTipoObjeto" offset="2"/>
					<left anchor="right" parent="BotonYelmo" offset="6" />
					<size height="33" width="33" />
				</anchored>
			</buttoncontrol>


			<spacer_column/><spacer_column/><spacer_column/><spacer_column/><spacer_column/><spacer_column/><spacer_column/><spacer_column/>

			
			<!-- ***************************************************************************
				 ***************************************************************************
							Campos Armadura y parte defensiva de Escudo y Casco/Yelmo
				 ***************************************************************************
				 *************************************************************************** -->
			
			<line_column name="divider3"/>
						
			<label_column name="LabelBonoDefensa">
				<static textres="item_label_bono_defensa" />
			</label_column>
			
			<number_columnh name="Defensa">
				<script>
					function onInit()
						setReadOnly(window.TipoObjeto.getValue()==Inventario.CteEscudo);
					end
					
					function onValueChanged()
						if DB.getValue(window.getDatabaseNode(), "carried", 0)==Inventario.CteEquipado then
							if window.TipoObjeto.getValue()==Inventario.CteArmadura	then Inventario.AniadirArmadura(window);
							elseif window.TipoObjeto.getValue()==Inventario.CteYelmo then Inventario.AniadirYelmo(window);
							elseif window.TipoObjeto.getValue()==Inventario.CteEscudo then Inventario.AniadirEscudo(window);
							end;
						end
					end
				</script>
			</number_columnh>

			<label_column name="LabelDanioDefensa">
				<static textres="item_label_danio_armadura" />
			</label_column>
			
			<number_columnh name="DanioDefensa">
				<script>
					function onValueChanged()
						if DB.getValue(window.getDatabaseNode(), "carried", 0)==Inventario.CteEquipado then
							if window.TipoObjeto.getValue()==Inventario.CteArmadura	then Inventario.AniadirArmadura(window);
							elseif window.TipoObjeto.getValue()==Inventario.CteEscudo then Inventario.AniadirEscudo(window);
							end;
						end
					end
				</script>
			</number_columnh>

			<label_column name="LabelTipoArmadura">
				<static textres="item_label_tipo_armadura" />
			</label_column>
			
			<button_stringcycler name="TipoDefensa">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelTipoArmadura" offset="-6"/>
					<left anchor="left" parent="LabelTipoArmadura" offset="90" />
					<size height="30" width="120" />
				</anchored>
				<parameters>
					<labelsres>TipoDefensa_Label_Blanda|TipoDefensa_Label_Dura</labelsres>
					<values>Blanda|Dura</values>
				</parameters>
				<script>
					function onValueChanged()
						if DB.getValue(window.getDatabaseNode(), "carried", 0)==Inventario.CteEquipado then Inventario.AniadirArmadura(window); end
					end
				</script>
			</button_stringcycler>

			<!--<spacer_column/><spacer_column/><spacer_column/><spacer_column/><spacer_column/>-->

			<label_column name="LabelTamanioArmadura">
				<static textres="item_label_tamanio" />
				<anchored>
					<top parent="LabelTipoArmadura" offset="2"/>
					<left anchor="left" parent="LabelTipoArmadura" />
					<size height="30" width="120" />
				</anchored>
			</label_column>
			
			<button_stringcycler name="TamanioArmadura">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelTamanioArmadura" offset="-2"/>
					<left anchor="left" parent="LabelTamanioArmadura" offset="90" />
					<size height="30" width="120" />
				</anchored>
				<parameters>
					<labelsres>tamanio_armadura_1|tamanio_armadura_2|tamanio_armadura_3|tamanio_armadura_4</labelsres>
					<values>-3/-2|-1/+1|+2/+3|+4</values>
				</parameters>
				<script>
					function onValueChanged()
						if DB.getValue(window.getDatabaseNode(), "carried", 0)==Inventario.CteEquipado then Inventario.AniadirArmadura(window); end
					end
				</script>
			</button_stringcycler>

			<!-- ***************************************************************************
				 ***************************************************************************
											Campos Casco/Yelmo
				 ***************************************************************************
				 *************************************************************************** -->
 
			<label_column name="LabelPenalizacionPercepcion">
				<static textres="item_label_penalizacion_percepcion" />
			</label_column>
			
			<number_columnh name="PenalizacionPercepcion">
				<script>
					function onValueChanged()
						if DB.getValue(window.getDatabaseNode(), "carried", 0)==Inventario.CteEquipado then Inventario.AniadirYelmo(window); end;
					end
				</script>
			</number_columnh>
			
			<label_column name="LabelTieneVisera">
				<static textres="item_label_tiene_visera" />
			</label_column>
			
			<button_checkbox_column name="TieneVisera">
				<script>
					function onValueChanged()
						if DB.getValue(window.getDatabaseNode(), "carried", 0)==Inventario.CteEquipado then Inventario.AniadirYelmo(window); end
					end
					
					function onInit()
						onValueChanged();
					end
				</script>
			</button_checkbox_column>

			<label_column name="LabelTamanioYelmo">
				<static textres="item_label_tamanio" />
			</label_column>
			
			<button_stringcycler name="TamanioYelmo" source="TamanioArmadura">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelTamanioYelmo" offset="-2"/>
					<left anchor="left" parent="LabelTamanioYelmo" offset="90" />
					<size height="30" width="120" />
				</anchored>
				<parameters>
					<labelsres>tamanio_armadura_1|tamanio_armadura_2|tamanio_armadura_3|tamanio_armadura_4</labelsres>
					<values>-3/-2|-1/+1|+2/+3|+4</values>
				</parameters>
				<script>
					function onValueChanged()
						if DB.getValue(window.getDatabaseNode(), "carried", 0)==Inventario.CteEquipado then Inventario.AniadirArmadura(window); end
					end
				</script>
			</button_stringcycler>


			<!-- ***************************************************************************
				 ***************************************************************************
									Campos Arma y parte ofensiva de escudo
				 ***************************************************************************
				 *************************************************************************** -->
				 
			<stringfield name="IDListaArmas">
				<bounds>102,111,150,20</bounds>
				<invisible />
				<readonly />
				<controlline />
				<lineoffset>-2</lineoffset>
			</stringfield>

			<number name="esEscudo">
				<bounds>102,111,150,20</bounds>
				<invisible />
				<readonly />
			</number>

			<label_column name="LabelUsoArma">
				<static textres="item_label_uso_arma" />
			</label_column>
			
			<button_iconcycler name="UsoArma">
				<parameters>
					<icons>char_weapon_melee_1hand|char_weapon_melee_2hands|char_weapon_melee_1_2hands|char_weapon_ranged|char_weapon_thrown</icons>
					<values>1|2|5|3|4</values>
					<tooltipsres>Arma de melé a una mano|Arma de melé a dos manos|Arma de rango|Arma arrojadiza</tooltipsres>
					<nodefault />
				</parameters>
				<anchored>
					<top parent="LabelUsoArma"/>
					<left anchor="left" parent="LabelUsoArma" offset="85" />
					<size height="30" width="60" />
				</anchored>
				<script>
					function onValueChanged()
						local sUsoArma=DB.getValue(window.getDatabaseNode(), "UsoArma", "");
						window.HabilidadCC.setVisible(sUsoArma==Inventario.CteUnaMano or sUsoArma==Inventario.CteDosManos or sUsoArma==Inventario.CteUnaDosManos);
						window.HabilidadPr.setVisible(sUsoArma==Inventario.CteRango);
						window.HabilidadAr.setVisible(sUsoArma==Inventario.CteArrojadiza);
						if sUsoArma==Inventario.CteUnaMano or sUsoArma==Inventario.CteDosManos or sUsoArma==Inventario.CteUnaDosManos then
							window.Habilidad.setValue(window.HabilidadCC.getValue());
							window.LabelLongAlc.setValue("Longitud");
							window.Longitud.setVisible(true);
							window.Alcance.setVisible(false);
							window.LabelRecarga.setVisible(false);
							window.Recarga.setVisible(false);
						elseif sUsoArma==Inventario.CteRango then
							window.Habilidad.setValue(window.HabilidadPr.getValue());
							window.LabelLongAlc.setValue("Alcance");
							window.Longitud.setVisible(false);
							window.Alcance.setVisible(true);
							window.LabelRecarga.setVisible(true);
							window.Recarga.setVisible(true);
						elseif sUsoArma==Inventario.CteArrojadiza then
							window.Habilidad.setValue(window.HabilidadAr.getValue());
							window.LabelLongAlc.setValue("Alcance");
							window.Longitud.setVisible(false);
							window.Alcance.setVisible(true);
							window.LabelRecarga.setVisible(false);
							window.Recarga.setVisible(false);
						end
						
						Inventario.ModificarArma(window);
					end
				</script>
			</button_iconcycler>

			<spacer_column/><spacer_column/><spacer_column/><spacer_column/><spacer_column/><spacer_column/><spacer_column/>

			<label_column name="LabelDanio">
				<static textres="item_label_danio_arma" />
			</label_column>

			<number_column name="BonoDanio">
				<script>
					function onValueChanged()
						Inventario.ModificarArma(window);
					end
				</script>
			</number_column>
			
			<string_columnh name="EfectoDanio" />
					
			<label_column name="LabelBonoAtaqueArma">
				<static textres="item_label_ataque_arma" />
			</label_column>
			
			<number_column name="BonoAtaqueArma">
				<script>
					function onValueChanged()
						Inventario.ModificarArma(window);
					end
				</script>
			</number_column>

			<label_column name="LabelFuerzaMinima">
				<static textres="item_label_fuerza_minima" />
			</label_column>
			
			<number_column name="FuerzaMinima">
				<script>
					function onValueChanged()
						Inventario.ModificarArma(window);
					end
				</script>
			</number_column>

			<label_column name="LabelTipoArma">
				<static textres="item_label_tipo_arma" />
			</label_column>
			
			<button_stringcycler name="TipoArma" source="TipoArma">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelTipoArma" offset="-5"/>
					<left anchor="left" parent="LabelTipoArma" offset="90" />
					<size height="30" width="180" />
				</anchored>
				<parameters>
					<labelsres>item_label_tipo_cortante|item_label_tipo_penetrante|item_label_tipo_contundente|item_label_tipo_desgarradora|item_label_tipo_cortante_penetrante|item_label_tipo_desgarradora_penetrante|item_label_tipo_contundente_penetrante|item_label_tipo_contundente_desgarradora</labelsres>
					<values>1|2|3|4|12|42|32|34</values>
				</parameters>
				<script>
					function onValueChanged()
						Inventario.ModificarArma(window);
					end				
				</script>
			</button_stringcycler>

			<label_column name="LabelLongAlc">
				<static text="Longitud" />
				<anchored>
					<top parent="LabelTipoArma" />
					<left anchor="left" parent="LabelTipoArma"/>
				</anchored>
			</label_column>

			<button_stringcycler name="Longitud" source="Longitud">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelLongAlc" offset="-5"/>
					<left anchor="left" parent="LabelLongAlc" offset="90" />
					<size height="30" width="120" />
				</anchored>
				<parameters>
					<labelsres>item_label_longitud_corta|item_label_longitud_media|item_label_longitud_media_larga|item_label_longitud_larga</labelsres>
					<values>Corta|Media|Media/Larga|Larga</values>
				</parameters>
				<script>
					function onValueChanged()
						Inventario.ModificarArma(window);
					end				
				</script>
			</button_stringcycler>

			<button_stringcycler name="Alcance" source="Alcance">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelLongAlc" offset="-5"/>
					<left anchor="left" parent="LabelLongAlc" offset="90" />
					<size height="30" width="120" />
				</anchored>
				<parameters>
					<labelsres>item_label_alcance_corto|item_label_alcance_medio|item_label_alcance_largo|item_label_alcance_muy_largo</labelsres>
					<values>Corto|Medio|Largo|Muy Largo</values>
				</parameters>
				<script>
					function onValueChanged()
						Inventario.ModificarArma(window);
					end				
				</script>
			</button_stringcycler>
												
			<label_column name="LabelHabilidad">
				<static textres="item_label_habilidad_arma" />
				<anchored>
					<top parent="LabelLongAlc"/>
					<left anchor="left" parent="LabelLongAlc"/>
					<size height="30" width="120" />
				</anchored>
			</label_column>
			
			<string_columnh name="Habilidad">
				<anchored>
					<top parent="LabelHabilidad" offset="-25"/>
				</anchored>
				<invisible />
				<readonly />
				<script>
					function onValueChanged()
						Inventario.ModificarArma(window);
					end
				</script>
			</string_columnh>

						
			<button_stringcycler name="HabilidadCC" source="HabilidadCC">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelHabilidad" offset="-5"/>
					<left anchor="left" parent="LabelHabilidad" offset="90" />
					<size height="30" width="120" />
				</anchored>
				<parameters>
					<labelsres>HabilidadCC_Label_Arma_de_asta|HabilidadCC_Label_Hacha|HabilidadCC_Label_L_tigo|HabilidadCC_Label_Mayal|HabilidadCC_Label_Maza|HabilidadCC_Label_Pelea|HabilidadCC_Label_Pu_al|HabilidadCC_Label_Red|HabilidadCC_Label_Espada</labelsres>
					<values>Arma de asta|Hacha|Latigo|Mayal|Maza|Pelea|Punal|Red|Espada</values>
				</parameters>
				<script>
					function onValueChanged()
						window.Habilidad.setValue(getStringValue());
					end				
				</script>
			</button_stringcycler>

			<button_stringcycler name="HabilidadPr" source="HabilidadPr">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelHabilidad" offset="-5"/>
					<left anchor="left" parent="LabelHabilidad" offset="90" />
					<size height="30" width="120" />
				</anchored>
				<parameters>
					<labelsres>HabilidadPr_Arco|HabilidadPr_Ballesta|HabilidadPr_Canon_de_Mano|Honda</labelsres>
					<values>Arco|Ballesta|Canon de mano|Honda</values>
				</parameters>
				<script>
					function onValueChanged()
						window.Habilidad.setValue(getStringValue());
					end				
				</script>
			</button_stringcycler>

			<button_stringcycler name="HabilidadAr" source="HabilidadAr">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelHabilidad" offset="-5"/>
					<left anchor="left" parent="LabelHabilidad" offset="90" />
					<size height="30" width="120" />
				</anchored>
				<parameters>
					<labelsres>HabilidadCC_Label_Arma_de_asta|HabilidadCC_Label_Hacha|HabilidadAr_Label_Lanzar|HabilidadCC_Label_Pu_al|HabilidadCC_Label_Red</labelsres>
					<values>Arma de asta|Hacha|Lanzar|Punal|Red</values>
				</parameters>
				<script>
					function onValueChanged()
						window.Habilidad.setValue(getStringValue());
					end				
				</script>
			</button_stringcycler>

			<label_column name="LabelRecarga">
				<static textres="item_label_recarga" />
				<anchored>
					<top parent="LabelHabilidad" offset="-5"/>
					<left anchor="left" parent="LabelHabilidad"/>
					<size height="30" width="120" />
				</anchored>
			</label_column>

			<button_stringcycler name="Recarga" source="Recarga">
				<frame>
				<name>fielddark</name>
				<offset>0,0,0,0</offset>
				</frame>
				<anchored>
					<top parent="LabelRecarga"/>
					<left anchor="left" parent="LabelRecarga" offset="90" />
					<size height="30" width="120" />
				</anchored>
				<parameters>
					<labelsres>item_label_recarga_retraso|item_label_recarga_1_turno|item_label_recarga_2_turnos|item_label_recarga_12_turnos|item_label_recarga_24_turnos</labelsres>
					<values>Retraso|1 turno|2 turnos|12 turnos|24 turnos</values>
				</parameters>
				<script>
					function onValueChanged()
						window.Habilidad.setValue(getStringValue());
					end				
				</script>
			</button_stringcycler>

			<!-- ***************************************************************************
				 ***************************************************************************
												Campo TipoObjeto
				 ***************************************************************************
				 *************************************************************************** -->

			<number name="TipoObjeto">
				<frame>
				<name>fielddark</name>
				</frame>
				<bounds>52,21,60,30</bounds>
				<invisible />
				<readonly />
				<default>5</default>
				<script>
					function onValueChanged()
						Inventario.CalcularPesoTotal(window);
						
						local bEsArma= window.TipoObjeto.getValue()==4;
						local bEsObjeto= window.TipoObjeto.getValue()==5;
						local bEsArmadura= window.TipoObjeto.getValue()==6;
						local bEsYelmo= window.TipoObjeto.getValue()==7;
						local bEsEscudo= window.TipoObjeto.getValue()==8;
						local sUsoArma=DB.getValue(window.getDatabaseNode(), "UsoArma", "");
						local bEsLongitud=sUsoArma==Inventario.CteUnaMano or sUsoArma==Inventario.CteDosManos or sUsoArma==Inventario.CteUnaDosManos;
						local bEsAlcance=sUsoArma==Inventario.CteRango or sUsoArma==Inventario.CteArrojadiza;
												
						window.BordeBotonArma.setVisible(bEsArma);
						window.BordeBotonArmadura.setVisible(bEsArmadura);
						window.BordeBotonEscudo.setVisible(bEsEscudo);
						window.BordeBotonYelmo.setVisible(bEsYelmo);
						window.BordeBotonMisc.setVisible(bEsObjeto);
												
						window.divider3.setVisible(not bEsObjeto);
						
						window.LabelBonoDefensa.setVisible(bEsArmadura or bEsYelmo or bEsEscudo);
						window.Defensa.setVisible(bEsArmadura or bEsYelmo or bEsEscudo);
						window.LabelDanioDefensa.setVisible(bEsArmadura or bEsEscudo);
						window.DanioDefensa.setVisible(bEsArmadura or bEsEscudo);
						window.LabelTamanioArmadura.setVisible(bEsArmadura or bEsCasco);
						window.TamanioArmadura.setVisible(bEsArmadura or bEsCasco);
						window.LabelTamanioArmadura.setVisible(bEsArmadura or bEsCasco);
						window.TamanioArmadura.setVisible(bEsArmadura or bEsCasco);
						window.LabelTipoArmadura.setVisible(bEsArmadura);
						window.TipoDefensa.setVisible(bEsArmadura);
												
						window.LabelHabilidad.setVisible(bEsArma or bEsEscudo);
						window.Habilidad.setVisible(bEsEscudo);
						window.HabilidadCC.setVisible(bEsArma and (sUsoArma==Inventario.CteUnaMano or sUsoArma==Inventario.CteDosManos or sUsoArma==Inventario.CteUnaDosManos));
						window.HabilidadPr.setVisible(bEsArma and sUsoArma==Inventario.CteRango);
						window.HabilidadAr.setVisible(bEsArma and sUsoArma==Inventario.CteArrojadiza);
						
						window.LabelDanio.setVisible(bEsArma or bEsEscudo);
						window.BonoDanio.setVisible(bEsArma or bEsEscudo);
						window.LabelBonoAtaqueArma.setVisible(bEsArma or bEsEscudo);
						window.BonoAtaqueArma.setVisible(bEsArma or bEsEscudo);
						window.LabelFuerzaMinima.setVisible(bEsArma or bEsEscudo);
						window.FuerzaMinima.setVisible(bEsArma or bEsEscudo);
						window.TipoArma.setVisible(bEsArma or bEsEscudo);
						window.LabelLongAlc.setVisible(bEsArma or bEsEscudo);
						window.Longitud.setVisible(bEsArma and bEsLongitud or bEsEscudo);
						window.Alcance.setVisible(bEsArma and bEsAlcance);
						window.LabelUsoArma.setVisible(bEsArma or bEsEscudo);
						window.UsoArma.setVisible(bEsArma or bEsEscudo);
						window.UsoArma.setReadOnly(bEsEscudo);
						window.EfectoDanio.setVisible(bEsArma or bEsEscudo);
						window.LabelTipoArma.setVisible(bEsArma or bEsEscudo);
						window.LabelRecarga.setVisible(bEsArma and sUsoArma==Inventario.CteRango);
						window.Recarga.setVisible(bEsArma and sUsoArma==Inventario.CteRango);
						if bEsEscudo then
							DB.setValue(window.getDatabaseNode(), "UsoArma", "string", Inventario.CteUnaMano);
							window.Habilidad.setValue("Escudo");
						elseif bEsArma then
							if sUsoArma==Inventario.CteUnaMano or sUsoArma==Inventario.CteDosManos or sUsoArma==Inventario.CteUnaDosManos then
								window.Habilidad.setValue(window.HabilidadCC.getStringValue());
							elseif sUsoArma==Inventario.CteRango then
								window.Habilidad.setValue(window.HabilidadPr.getStringValue());
							elseif sUsoArma==Inventario.CteArrojadiza then
								window.Habilidad.setValue(window.HabilidadAr.getStringValue());
							else
								window.Habilidad.setValue("");
							end
						end
						
						window.LabelPenalizacionPercepcion.setVisible(bEsYelmo);
						window.PenalizacionPercepcion.setVisible(bEsYelmo);
						window.LabelTieneVisera.setVisible(bEsYelmo);
						window.TieneVisera.setVisible(bEsYelmo);
					end
					
					function onInit()
						onValueChanged();
					end
				</script>
				<!--
						window.LabelArmadura.setVisible(bEsArmadura);
						window.LabelYelmo.setVisible(bEsYelmo);
						window.LabelEscudo.setVisible(bEsEscudo);
						window.LabelArma.setVisible(bEsArma);

						window.LabelViseraLevantada.setVisible(bEsYelmo and window.TieneVisera.getValue()==1);
						window.ViseraLevantada.setVisible(bEsYelmo and window.TieneVisera.getValue()==1);

				-->
			</number>
			<number name="TipoObjetoAnt">
				<invisible />
				<readonly />
				<bounds>36,53,60,30</bounds>
				<default>-1</default>
			</number>

		</sheetdata>
	</windowclass>
</root>